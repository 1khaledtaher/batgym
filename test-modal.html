<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„</title>
  <link rel="stylesheet" href="mobile-style.css">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="app-header">
      <div class="header-content">
        <div class="header-left">
          <h1>Gym Social</h1>
        </div>
        <div class="header-right">
          <button class="icon-btn">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>
    </header>
    
    <!-- Feed -->
    <section class="community-feed" id="home-feed">
      <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
    </section>
  </div>
  
  <script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙˆØ³ØªØ§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
    const socialPosts = [
      {
        user: 'ahmed_fit',
        avatar: 'https://randomuser.me/api/portraits/men/32.jpg',
        time: 'Ù…Ù†Ø° 10 Ø¯Ù‚Ø§Ø¦Ù‚',
        media: { type: 'image', url: 'https://images.unsplash.com/photo-1517960413843-0aee8e2d471c?auto=format&fit=crop&w=400&q=80' },
        text: 'Ø£ÙƒÙ…Ù„Øª ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØµØ¯Ø± Ø§Ù„ÙŠÙˆÙ…! ğŸ’ªğŸ”¥ Ø¶ØºØ· Ø§Ù„Ø¨Ù†Ø´ 100 ÙƒØ¬Ù… Ã— 8 ØªÙƒØ±Ø§Ø±Ø§Øª. Ø§Ù„Ø´Ø¹ÙˆØ± Ø±Ù‡ÙŠØ¨!',
        likes: 24,
        liked: true,
        comments: [
          { user: 'mona', text: 'Ø¨Ø±Ø§ÙÙˆ Ø¹Ù„ÙŠÙƒ! ğŸ”¥', likes: 3 },
          { user: 'coach_ali', text: 'Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! Ø§Ø³ØªÙ…Ø± Ù‡ÙƒØ°Ø§', likes: 2 },
          { user: 'fitness_lover', text: 'Ø£Ù†Ø§ ÙƒÙ…Ø§Ù† Ø¨Ø¯Ø£Øª ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØµØ¯Ø± Ø§Ù„ÙŠÙˆÙ… ğŸ’ª', likes: 1 }
        ]
      },
      {
        user: 'sara.gym',
        avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
        time: 'Ù…Ù†Ø° Ø³Ø§Ø¹Ø©',
        media: { type: 'image', url: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80' },
        text: 'ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„ÙŠÙ† ÙƒØ§Ù† Ù…ØªØ¹Ø¨ Ø¨Ø³ Ù…Ù…ØªØ¹! ğŸ¦µâœ¨ Ø§Ù„Ù‚Ø±ÙØµØ§Ø¡ 80 ÙƒØ¬Ù… Ã— 10 ØªÙƒØ±Ø§Ø±Ø§Øª Ã— 4 Ù…Ø¬Ù…ÙˆØ¹Ø§Øª',
        likes: 31,
        liked: false,
        comments: [
          { user: 'ahmed_fit', text: 'ğŸ”¥ğŸ”¥ Ø£Ø¯Ø§Ø¡ Ù‚ÙˆÙŠ!', likes: 5 },
          { user: 'coach', text: 'Ø§Ø³ØªÙ…Ø±ÙŠ! Ø§Ù„Ø±Ø¬Ù„ÙŠÙ† Ø£Ø³Ø§Ø³ Ø§Ù„Ø¬Ø³Ù…', likes: 4 }
        ]
      }
    ];

    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙˆØ³ØªØ§Øª
    function renderHomeFeed() {
      const homeFeed = document.getElementById('home-feed');
      if (!homeFeed) return;
      
      homeFeed.innerHTML = socialPosts.map((post, idx) => {
        let topComments = (post.comments||[]).slice().sort((a,b)=>(b.likes||0)-(a.likes||0)).slice(0,2);
        return `
        <div class="community-post" data-idx="${idx}" onclick="showPostDetails(${idx})">
          <div class="post-header">
            <img class="avatar" src="${post.avatar}" alt="${post.user}" style="object-fit:cover;">
            <div class="user-info">
              <span class="username">${post.user}</span>
              <span class="time">${post.time}</span>
            </div>
          </div>
          ${post.media ? (post.media.type === 'image' ? `<img class="post-image" src="${post.media.url}" alt="post">` : `<video class="post-image" src="${post.media.url}" controls></video>`) : ''}
          <div class="post-text">${post.text}</div>
          <div class="post-actions" onclick="event.stopPropagation()">
            <button class="like-btn${post.liked ? ' liked' : ''}" data-idx="${idx}" onclick="toggleLike(${idx})"><i class="fas fa-heart"></i> <span>${post.likes}</span></button>
            <button class="comment-btn" data-idx="${idx}"><i class="fas fa-comment"></i> <span>${post.comments.length}</span></button>
          </div>
          <div class="comments-list">
            ${topComments.map((c, cidx) => `
              <div class="comment">
                <div class="comment-content"><b>${c.user}:</b> ${c.text}</div>
                <button class="comment-like-btn${c.liked ? ' liked' : ''}" onclick="toggleCommentLike(${idx}, ${cidx})">
                  <i class="fas fa-heart"></i>
                  <span class="comment-like-count">${c.likes || 0}</span>
                </button>
              </div>
            `).join('')}
            ${post.comments.length > 2 ? `<div class="more-comments">Ø¹Ø±Ø¶ ${post.comments.length - 2} ØªØ¹Ù„ÙŠÙ‚ Ø¥Ø¶Ø§ÙÙŠ</div>` : ''}
          </div>
        </div>
        `;
      }).join('');
    }

    // Ø¯Ø§Ù„Ø© ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„
    function showPostDetails(idx) {
      console.log('Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„Ø¨ÙˆØ³Øª Ø±Ù‚Ù…:', idx);
      const post = socialPosts[idx];
      if (!post) {
        console.log('Ø§Ù„Ø¨ÙˆØ³Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        return;
      }
      console.log('ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ³Øª:', post.user);
      
      // Ø¨Ù†Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„
      let modal = document.getElementById('postDetailsModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'postDetailsModal';
        modal.className = 'modal-overlay post-details-overlay';
        modal.innerHTML = `
          <div class='modal post-details-modal'>
            <div class='post-details-header'>
              <div class='post-details-user'>
                <img class='avatar' src='${post.avatar}' alt='${post.user}'>
                <div class='user-info'>
                  <span class='username'>${post.user}</span>
                  <span class='time'>${post.time}</span>
                </div>
              </div>
              <button class='close-btn' onclick='closePostDetails()'>
                <i class='fas fa-times'></i>
              </button>
            </div>
            <div class='post-details-content'>
              <div class='post-details-media'></div>
              <div class='post-details-info'>
                <div class='post-details-actions'>
                  <button class='like-btn${post.liked ? ' liked' : ''}' data-idx="${idx}" onclick="toggleLikeInModal(${idx})">
                    <i class='fas fa-heart'></i>
                  </button>
                  <button class='comment-btn' onclick="focusCommentInput()">
                    <i class='fas fa-comment'></i>
                  </button>
                  <button class='share-btn'>
                    <i class='fas fa-share'></i>
                  </button>
                </div>
                <div class='post-details-likes'>
                  <span class='likes-count'>${post.likes} Ø¥Ø¹Ø¬Ø§Ø¨</span>
                </div>
                <div class='post-details-text'>
                  <span class='username'>${post.user}</span> ${post.text}
                </div>
                <div class='post-details-comments'></div>
                <div class='post-details-add-comment'>
                  <input type='text' placeholder='Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹...' class='comment-input'>
                  <button class='post-comment-btn' disabled>Ù†Ø´Ø±</button>
                </div>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      } else {
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
        modal.querySelector('.post-details-user .avatar').src = post.avatar;
        modal.querySelector('.post-details-user .username').textContent = post.user;
        modal.querySelector('.post-details-user .time').textContent = post.time;
        modal.querySelector('.like-btn').className = `like-btn${post.liked ? ' liked' : ''}`;
        modal.querySelector('.like-btn').setAttribute('data-idx', idx);
        modal.querySelector('.like-btn').setAttribute('onclick', `toggleLikeInModal(${idx})`);
        modal.querySelector('.likes-count').textContent = `${post.likes} Ø¥Ø¹Ø¬Ø§Ø¨`;
        modal.querySelector('.post-details-text').innerHTML = `<span class='username'>${post.user}</span> ${post.text}`;
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ³Ø§Ø¦Ø·
      const mediaContainer = modal.querySelector('.post-details-media');
      if (post.media) {
        if (post.media.type === 'image') {
          mediaContainer.innerHTML = `<img src='${post.media.url}' alt='post'>`;
        } else if (post.media.type === 'video') {
          mediaContainer.innerHTML = `<video src='${post.media.url}' controls></video>`;
        }
      } else {
        mediaContainer.innerHTML = '';
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
      updateModalComments(idx);
      
      modal.style.display = 'flex';
      modal.style.opacity = '1';
      modal.style.visibility = 'visible';
      
      console.log('ØªÙ… Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©');
      
      // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©
      document.body.style.overflow = 'hidden';
    }

    // Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
    function closePostDetails() {
      const modal = document.getElementById('postDetailsModal');
      if (modal) {
        modal.style.display = 'none';
        modal.style.opacity = '0';
        modal.style.visibility = 'hidden';
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        document.body.style.overflow = 'auto';
      }
    }

    // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
    function updateModalComments(postIdx) {
      const post = socialPosts[postIdx];
      if (!post) return;
      
      const modal = document.getElementById('postDetailsModal');
      if (!modal) return;
      
      const commentsContainer = modal.querySelector('.post-details-comments');
      const allComments = (post.comments || []).slice().sort((a,b) => (b.likes||0)-(a.likes||0));
      
      if (allComments.length > 0) {
        const commentsHtml = allComments.map((c, cidx) => `
          <div class='post-details-comment'>
            <div class='comment-content'>
              <span class='username'>${c.user}</span> ${c.text}
            </div>
            <div class='comment-actions'>
              <button class='comment-like-btn${c.liked ? ' liked' : ''}' onclick="toggleCommentLikeInModal(${postIdx}, ${cidx})">
                <i class='fas fa-heart'></i>
              </button>
            </div>
          </div>
        `).join('');
        commentsContainer.innerHTML = commentsHtml;
      } else {
        commentsContainer.innerHTML = '<div class="no-comments">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯</div>';
      }
    }

    // Ø¯Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
    function toggleLike(postIndex) {
      const post = socialPosts[postIndex];
      if (!post) return;
      
      post.liked = !post.liked;
      post.likes += post.liked ? 1 : -1;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      const likeBtn = document.querySelector(`[data-idx="${postIndex}"].like-btn`);
      if (likeBtn) {
        likeBtn.classList.toggle('liked', post.liked);
        likeBtn.querySelector('span').textContent = post.likes;
      }
    }

    // Ø¯Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø¥Ø¹Ø¬Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
    function toggleCommentLike(postIndex, commentIndex) {
      const post = socialPosts[postIndex];
      if (!post || !post.comments || !post.comments[commentIndex]) return;
      
      const comment = post.comments[commentIndex];
      comment.liked = !comment.liked;
      comment.likes = (comment.likes || 0) + (comment.liked ? 1 : -1);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      renderHomeFeed();
    }

    // Ø¯Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
    function toggleLikeInModal(postIdx) {
      const post = socialPosts[postIdx];
      if (!post) return;
      
      post.liked = !post.liked;
      if (post.liked) {
        post.likes++;
      } else {
        post.likes = Math.max(0, post.likes - 1);
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø§ÙØ°Ø©
      const modal = document.getElementById('postDetailsModal');
      if (modal) {
        const likeBtn = modal.querySelector('.like-btn');
        const likesCount = modal.querySelector('.likes-count');
        
        likeBtn.className = `like-btn${post.liked ? ' liked' : ''}`;
        likesCount.textContent = `${post.likes} Ø¥Ø¹Ø¬Ø§Ø¨`;
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
      renderHomeFeed();
    }

    // Ø¯Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø¥Ø¹Ø¬Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
    function toggleCommentLikeInModal(postIdx, commentIdx) {
      const post = socialPosts[postIdx];
      if (!post || !post.comments || !post.comments[commentIdx]) return;
      
      const comment = post.comments[commentIdx];
      comment.liked = !comment.liked;
      if (comment.liked) {
        comment.likes = (comment.likes || 0) + 1;
      } else {
        comment.likes = Math.max(0, (comment.likes || 0) - 1);
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø§ÙØ°Ø©
      updateModalComments(postIdx);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
      renderHomeFeed();
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
    function focusCommentInput() {
      const commentInput = document.querySelector('.comment-input');
      if (commentInput) {
        commentInput.focus();
      }
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Ø§Ù„ØµÙØ­Ø© ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§');
      console.log('Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØ³ØªØ§Øª:', socialPosts.length);
      renderHomeFeed();
    });
  </script>
</body>
</html> 